<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Optimal Operation in Power Systems - Talha Rehman</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 2rem;
      background: #f9f9f9;
      line-height: 1.6;
    }

    h1,
    h2,
    h3 {
      color: #2c3e50;
    }

    pre {
      background: #272822;
      color: #f8f8f2;
      padding: 1em;
      overflow-x: auto;
      border-radius: 5px;
    }

    code {
      font-family: Consolas, monospace;
    }

    .section {
      margin-bottom: 3rem;
    }

    .code-title {
      background: #444;
      color: #fff;
      padding: 0.5em 1em;
      border-radius: 5px 5px 0 0;
    }

    img.model {
      display: block;
      margin: 1rem auto;
      max-width: 90%;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 4px;
      background: white;
    }
  </style>
</head>

<body>
  <h1>Optimal Operation in Power Systems</h1>
  <p><strong>Author:</strong> Talha Rehman @Incheon National University<br>
    <strong>Course:</strong> Advanced System Operation<br>
  </p>

  <div class="section">
    <h2>Introduction</h2>
    <p>
      Optimization is the decision-making of how we can utilize the limited amount of resources in the best way
      (optimally!) such that we achieve our desired goal (objective) while also respecting any given conditions
      (constraints).
    </p>
    <p>
      <em>
        For example, in a power system, if we have three generators each with its own cost function and a 24-hour demand
        forecast for the next day, then day-ahead decision-making involves deciding how to operate those generators so
        that:<br>
        The total system cost is minimized.<br>
        Supply and demand remain balanced.<br>
        Network security and resource constraints are never violated.<br>
        This way, we run the generators optimally to meet tomorrowâ€™s demand at the lowest possible cost!
      </em>
    </p>
  </div>


  <div class="section">
    <h2>Microgrid Overview</h2>
    <p>Microgrids are the small scale power grid, that has there own distributed generation resources and demand. It can
      be connected to the external grid while it can also operate in the islanded mode.</p>
    <div class="image-placeholder">
      <img src="images/microgird.png" alt="Microgrid diagram or concept" style="max-width: 100%; height: auto;">
    </div>
  </div>

  <div class="section">
    <h2>Optimization Model</h2>
    <p>The microgrid optimization problem is formulated as a Mixed Integer Linear Programming (MILP) problem with the
      following components:</p>
    <ul>
      <<li>
        <strong>Objective Function:</strong><br>
        Minimize:<br>
        &nbsp;&nbsp;&nbsp;e.g. cost, load shedding.<br>
        Maximize:<br>
        &nbsp;&nbsp;&nbsp;e.g. profit.
        </li>

        <li>
          <strong>Decision Variables:</strong><br>
          Continuous:<br>
          &nbsp;&nbsp;&nbsp;e.g. generator power, load-shedding amount.<br>
          Binary:<br>
          &nbsp;&nbsp;&nbsp;e.g. on/off status of line or battery charging/discharging status.<br>
          Discrete integers:<br>
          &nbsp;&nbsp;&nbsp;e.g. number of generators to install.
        </li>
        <li>
          <strong>Constraints:</strong><br>
          Power balance constraints.<br>
          Limiting constraints:<br>
          &nbsp;&nbsp;&nbsp;e.g. generators minimum and maximum limits.<br>
          Operational constraints:<br>
          &nbsp;&nbsp;&nbsp;e.g. state of charge of the battery.<br>
          Binary constraints:<br>
          &nbsp;&nbsp;&nbsp;e.g. controlling that the charging and discharging don't happen at the same time.
        </li>
    </ul>
  </div>

  <div class="section">
    <h2>Economic Dispatch (Optimal Operations)</h2>
    <p>Economic dispatch refers to determining the operational schedules of dispatchable generators, energy storage
      systems, and external grid exchanges so that the total operational cost of the system is minimized, subject to all
      operational and limit constraints.</p>
    <h3>Consider the below system as an example</h3>
    <div class="image-placeholder">
      <img src="images/test_system.png" alt="Test System" style="max-width: 100%; height: auto;">
    </div>
    <p>The above system has 5lines, 4buses, 2DGs, 2Load, 1BESS, 1RES, and an external grid connection.</p>

    <h3>Centralized Approach</h3>
    <p>To determine the operational schedule of the system we solve the optimization model. The centralized approach
      assumes that there is a central controller (energy management system EMS) that performs optimization.
    </p>
    <div class="image-placeholder">
      <img src="images/centralized_image.png" alt="Centralized Approach" style="max-width: 100%; height: auto;">
    </div>

    <h3>Mathematical Model</h3>
    <p>The objective of microgrid is to minimize the cost while maintaining supply and demand balance. The optimization
      model is as follows:</p>
    <div class="image-placeholder">
      <img src="images/model_equations.JPG" alt="Centralized Model Equations" style="max-width: 100%; height: auto;">
    </div>
  </div>

  <div class="section">
    <h2>Code Implementation</h2>
    <p>The C++ implementation uses IBM CPLEX for optimization. Below is a detailed explanation of key code segments.</p>

    <h3>1. System Parameters and Topology</h3>
    <div class="code-title">Microgrid Constants and Network</div>
    <pre><code>const int T = 24; // Time horizon
const int numBuses = 4, numDGs = 2, numLoads = 2, numBESS = 1, numRES = 1;
std::vector&lt;std::pair&lt;int, int&gt;&gt; lines = {{0, 1}, {1, 2}, {2, 3}, {3, 0}, {0, 2}};
// Susceptance matrix construction for power flow</code></pre>

    <h3>2. Input Data and Location Assignment</h3>
    <pre><code>dg_locations[0][1] = 1; // DG1 at Bus 2
battery_location[0] = 1; // Battery at Bus 1
load_locations[0][1] = 1; // Load1 at Bus 2</code></pre>

    <h3>3. Cost and Demand Profiles</h3>
    <pre><code>std::vector&lt;double&gt; c_buy = {90, 90, 90, ..., 80};
std::vector&lt;std::vector&lt;double&gt;&gt; p_load = {...};
std::vector&lt;double&gt; p_res = {...};</code></pre>

    <h3>4. Decision Variables</h3>
    <pre><code>IloNumVarArray p_buy(env, T, 0, IloInfinity, ILOFLOAT);
IloNumVarArray soc(env, T, 0, 1, ILOFLOAT);</code></pre>

    <h3>5. Objective Function</h3>
    <pre><code>for (int t = 0; t &lt; T; t++) {
    objective += c_buy[t] * p_buy[t] - price_scale * c_buy[t] * p_sell[t];
    for (int i = 0; i &lt; numDGs; ++i)
        objective += dgs[i].cost_per_mwh * p_dg[i][t];
}</code></pre>

    <h3>6. Power Balance Constraint</h3>
    <pre><code>// Without OPF:
model.add(p_buy[t] + p_res[t] + p_dg[0][t] + p_dg[1][t] + p_bess_dch[t] == 
          p_bess_chg[t] + p_load[0][t] + p_load[1][t] + p_sell[t]);</code></pre>

    <h3>7. Battery Operation Constraints</h3>
    <pre><code>model.add(soc[t] == soc[t - 1] + (p_bess_chg[t] * eta - p_bess_dch[t] / eta) / p_bess_max);
model.add(p_bess_chg[t] &lt;= omega[t] * M);
model.add(p_bess_dch[t] &lt;= (1 - omega[t]) * M);</code></pre>

    <h3>8. Result Export</h3>
    <p>After solving the model, results are saved to CSV files:</p>
    <pre><code>std::ofstream resultFile("results.csv");
resultFile &lt;&lt; "Hour,Grid_Buy,Grid_Sell,DG1,DG2,Load,RES,BESS_Charge,BESS_Discharge,SoC\n";
for (...) { resultFile &lt;&lt; ... }</code></pre>
  </div>

  <div class="section">
    <h2>Optimal Power Flow (Optional)</h2>
    <p>When enabled, OPF includes bus angle variables and power flow limits for lines. The model accounts for
      susceptance matrix and limits the power exchanged between buses.</p>
  </div>

  <div class="section">
    <h2>Conclusion</h2>
    <p>This project models and solves the optimal operation of a microgrid over 24 hours. It highlights the importance
      of MILP in energy management, showcasing how economic dispatch, storage operation, and optional power flow
      constraints are handled in a centralized framework.</p>
  </div>

  <footer>
    <hr>
    <p>Developed by Talha Rehman | <a href="https://talharehmanmtrkt.github.io/seminar-content-ASO/">Project Page</a>
    </p>
  </footer>
</body>

</html>