<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Optimal Operation in Power Systems - Talha Rehman</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />
  <!-- Your custom CSS -->
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <h1>Optimal Operation in Power Systems</h1>
  <p><strong>Author:</strong> Talha Rehman @Incheon National University 20-05-2025<br />
    <strong>Presentation Content For Course:</strong> Advanced System Operation<br />
  </p>

  <div class="section">
    <h2>Introduction</h2>
    <p>
      Optimization is the decision-making of how we can utilize the limited amount of resources in the best way
      (optimally!) such that we achieve our desired goal (objective) while also respecting any given conditions
      (constraints).
    </p>
    <p><em>
        For example, in a power system, if we have three generators each with its own cost function and a 24-hour demand
        forecast for the next day, then day-ahead decision-making involves deciding how to operate those generators so
        that:
      </em></p>
    <ul>
      <li><em>The total system cost is minimized.</em></li>
      <li><em>Supply and demand remain balanced.</em></li>
      <li><em>Network security and resource constraints are never violated.</em></li>
    </ul>
    <p><em>
        This way, we run the generators optimally to meet tomorrow’s demand at the lowest possible cost!
      </em></p>

  </div>

  <div class="section">
    <h2>Microgrid Overview</h2>
    <p>
      Microgrids are the small scale power grid, that has there own distributed generation resources and demand. It can
      be connected to the external grid while it can also operate in the islanded mode.
    </p>
    <div class="image-placeholder">
      <img src="images/microgird.png" alt="Microgrid diagram or concept" style="max-width: 60%; height: auto" />
    </div>
  </div>

  <div class="section">
    <h2>Optimization Model</h2>
    <p>The microgrid optimization problem is formulated as a Mixed Integer Linear Programming (MILP) problem with the
      following components:</p>
    <ul>
      <li>
        <strong>Objective Function:</strong><br />
        Minimize:<br />
        &nbsp;&nbsp;&nbsp;e.g. cost, load shedding.<br />
        Maximize:<br />
        &nbsp;&nbsp;&nbsp;e.g. profit.
      </li>

      <li>
        <strong>Decision Variables:</strong><br />
        Continuous:<br />
        &nbsp;&nbsp;&nbsp;e.g. generator power, load-shedding amount.<br />
        Binary:<br />
        &nbsp;&nbsp;&nbsp;e.g. on/off status of line or battery charging/discharging status.<br />
        Discrete integers:<br />
        &nbsp;&nbsp;&nbsp;e.g. number of generators to install.
      </li>
      <li>
        <strong>Constraints:</strong><br />
        Power balance constraints.<br />
        Limiting constraints:<br />
        &nbsp;&nbsp;&nbsp;e.g. generators minimum and maximum limits.<br />
        Operational constraints:<br />
        &nbsp;&nbsp;&nbsp;e.g. state of charge of the battery.<br />
        Binary constraints:<br />
        &nbsp;&nbsp;&nbsp;e.g. controlling that the charging and discharging don't happen at the same time.
      </li>
    </ul>
  </div>

  <div class="section">
    <h2>Economic Dispatch (Optimal Operations)</h2>
    <p>
      Economic dispatch refers to determining the operational schedules of dispatchable generators, energy storage
      systems, and external grid exchanges so that the total operational cost of the system is minimized, subject to all
      operational and limit constraints.
    </p>
    <h3>Consider The Below System As An Example</h3>
    <div class="image-placeholder">
      <img src="images/test_system.png" alt="Test System" style="max-width: 60%; height: auto" />
    </div>
    <p>The above system has 5lines, 4buses, 2DGs, 2Load, 1BESS, 1RES, and an external grid connection.</p>

    <h3>Centralized Approach</h3>
    <p>
      To determine the operational schedule of the system we solve the optimization model. The centralized approach
      assumes that there is a central controller (energy management system EMS) that performs optimization.
    </p>
    <div class="image-placeholder">
      <img src="images/centralized_image.png" alt="Centralized Approach" style="max-width: 60%; height: auto" />
    </div>

    <h3>Mathematical Model</h3>
    <p>
      The objective of microgrid is to minimize the cost while maintaining supply and demand balance. The optimization
      model is as follows:
    </p>
    <div class="image-placeholder">
      <img src="images/model_equations.JPG" alt="Centralized Model Equations" style="max-width: 60%; height: auto" />
    </div>

    <h3>Operation Results Figure</h3>
    <div class="image-placeholder">
      <img src="images/centralized_results.png" alt="Centralized Model Equations"
        style="max-width: 80%; height: auto" />
    </div>

    <h3>Operation Results Data Table</h3>
    <table id="csvTable" class="display" style="width: 100%"></table>
  </div>


  <div class="section">
    <h2>Optimal Power Flow</h2>
    <p>In optimal power flow, we consider network constraints—such as limits of line and bus voltages—and determine both
      power flows and dispatch schedule. linear power flow model assumes “linear mathematical formulation”, consider
      only each line susceptance and buses voltage angles.
    </p>
    <div class="image-placeholder">
      <img src="images/opf_figure.png" alt="Optimal Power Flow" style="max-width: 60%; height: auto" />
    </div>
    <h3>Changes in Mathematical Model</h3>
    <p>The nodal power balance equation is:
    </p>
    <div class="image-placeholder">
      <img src="images/opf_model.png" alt="Optimal Power Flow" style="max-width: 60%; height: auto" />
    </div>
    <p></p>While the objective function and other constraints remains the same as in centralized mathematical modelling.
    </p>

    <h3>Optimal Power Flow Results</h3>
    <div>
      <ul class="tab-buttons">
        <li><button class="tab-btn active" data-tab="thetaTab">Theta Results</button></li>
        <li><button class="tab-btn" data-tab="powerflowTab">Power Flow Results</button></li>
      </ul>

      <div id="thetaTab" class="tab-content active">
        <table id="thetaTable" class="display" style="width: 100%"></table>
      </div>

      <div id="powerflowTab" class="tab-content">
        <table id="powerflowTable" class="display" style="width: 100%"></table>
      </div>
    </div>
  </div>




  <div class="section">
    <h2>Code Implementation</h2>
    <p>The C++ implementation uses IBM CPLEX for optimization. Below is a detailed explanation of key code segments.</p>

    <h3>1. System Parameters and Topology</h3>
    <div class="code-title">Microgrid Constants and Network</div>
    <pre><code>const int T = 24; // Time horizon
const int numBuses = 4, numDGs = 2, numLoads = 2, numBESS = 1, numRES = 1;
std::vector&lt;std::pair&lt;int, int&gt;&gt; lines = {{0, 1}, {1, 2}, {2, 3}, {3, 0}, {0, 2}};
// Susceptance matrix construction for power flow</code></pre>

    <h3>2. Input Data and Location Assignment</h3>
    <pre><code>dg_locations[0][1] = 1; // DG1 at Bus 2
battery_location[0] = 1; // Battery at Bus 1
load_locations[0][1] = 1; // Load1 at Bus 2</code></pre>

    <h3>3. Cost and Demand Profiles</h3>
    <pre><code>std::vector&lt;double&gt; c_buy = {90, 90, 90, ..., 80};
std::vector&lt;std::vector&lt;double&gt;&gt; p_load = {...};
std::vector&lt;double&gt; p_res = {...};</code></pre>

    <h3>4. Decision Variables</h3>
    <pre><code>IloNumVarArray p_buy(env, T, 0, IloInfinity, ILOFLOAT);
IloNumVarArray soc(env, T, 0, 1, ILOFLOAT);</code></pre>

    <h3>5. Objective Function</h3>
    <pre><code>for (int t = 0; t &lt; T; t++) {
    objective += c_buy[t] * p_buy[t] - price_scale * c_buy[t] * p_sell[t];
    for (int i = 0; i &lt; numDGs; ++i)
        objective += dgs[i].cost_per_mwh * p_dg[i][t];
}</code></pre>

    <h3>6. Power Balance Constraint</h3>
    <pre><code>// Without OPF:
model.add(p_buy[t] + p_res[t] + p_dg[0][t] + p_dg[1][t] + p_bess_dch[t] == 
          p_bess_chg[t] + p_load[0][t] + p_load[1][t] + p_sell[t]);</code></pre>

    <h3>7. Battery Operation Constraints</h3>
    <pre><code>model.add(soc[t] == soc[t - 1] + (p_bess_chg[t] * eta - p_bess_dch[t] / eta) / p_bess_max);
model.add(p_bess_chg[t] &lt;= omega[t] * M);
model.add(p_bess_dch[t] &lt;= (1 - omega[t]) * M);</code></pre>

    <h3>8. Result Export</h3>
    <p>After solving the model, results are saved to CSV files:</p>
    <pre><code>std::ofstream resultFile("results.csv");
resultFile &lt;&lt; "Hour,Grid_Buy,Grid_Sell,DG1,DG2,Load,RES,BESS_Charge,BESS_Discharge,SoC\n";
for (...) { resultFile &lt;&lt; ... }</code></pre>
  </div>


  <div class="section">
    <h2>Conclusion</h2>
    <p>This project models and solves the optimal operation of a microgrid over 24 hours. It highlights the importance
      of MILP in energy management, showcasing how economic dispatch, storage operation, and optional power flow
      constraints are handled in a centralized framework.</p>
  </div>

  <footer>
    <hr />
    <p>
      Developed by Talha Rehman |
      <a href="https://talharehmanmtrkt.github.io/seminar-content-ASO/" target="_blank">Project Page</a> |
      <a href="https://github.com/TalhaRehmanMTRKT" target="_blank">GitHub</a> |
      <a href="https://www.linkedin.com/in/muhammad-talha-rehman-khan-tareen/" target="_blank">LinkedIn</a> |
      <a href="https://scholar.google.com/citations?user=j_AybA4AAAAJ&hl=en" target="_blank">Google Scholar</a>
    </p>
  </footer>


  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- DataTables JS -->
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <!-- PapaParse CSV parser -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <!-- Your custom JS -->
  <script src="script.js"></script>
</body>

</html>